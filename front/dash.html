<!doctype html>
<html>
<head>
    <link rel="shortcut icon" href="/front/img/logo/logo-192.png">
    <link rel="apple-touch-icon" href="/front/img/logo/logo-192.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    
    
    <link rel="stylesheet" href="/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/node_modules/@fortawesome/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="/node_modules/summernote/dist/summernote-bs4.css"><!-- pre-minified -->
    <link rel="stylesheet" href="/front/helpers.css">
    <link rel="stylesheet" href="/front/general.css">
    <link rel="stylesheet" href="/front/dash.css">
    
    <title>ZapFeedback</title>
</head>
<body class="container">

    <div class="spinner">
        <span class="spinnerInner">
            <i class="fa fa-fw fa-spinner fa-spin"></i>
            <span class="spinnerFlash">Loading ...</span>
        </span>
    </div>

    
    <script type="text/html" id="ukSource"> <!-- /> -->
        <%
            window.model = model;
            var m = uk.snapshot(model);
            window.m = m;
            window.K = m.K;
        %>
        <header class="">
            <div class="dropdown float-right mt-1">
                <button class="btn btn-light btn-sm" type="button" id="primaryDropdownMenuButton"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                >
                    <span class="d-none d-sm-inline">
                        <i class="fa fa-fw fa-user"></i>
                        Hi {{app.c.currentUser.get().fname}}!
                        &nbsp; <span class="lightGray small">|</span> &nbsp;
                    </span>
                    Menu <i class="fa fa-fw fa-chevron-circle-down"></i>
                </button>&nbsp;
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="primaryDropdownMenuButton">
                    <a class="dropdown-item" href="?id=surveyLister">
                        <i class="fa fa-fw fa-file-alt"></i>&nbsp; Surveys
                    </a>
                    <a class="dropdown-item" href="?id=userLister">
                        <i class="fa fa-fw fa-users"></i>&nbsp; Users
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/logout">
                        <i class="fa fa-fw fa-sign-out-alt"></i>&nbsp; Log Out
                    </a>
                </div>
            </div>
            <a class="unsetColor noUnderline" href="?id=surveyLister" style="font-size: 24px;">
                <img class="verticalMiddle" src="/front/img/logo/logo-192.png" width="24">
                <span class="verticalMiddle">ZapFeedback</span>
            </a>
            <hr>
        </header>
    
    
        <!-- PLACEHOLDER ROUTE: 'surveyLister' -->
        <div class="{{ m.router.ifRoute('surveyLister') }}" id="surveyLister">
            <% if (true && m.router.c.activeId === "surveyLister") { %>
                <header>
                    <button class="btn btn-light float-right" data-on="click" data-call="/surveyLister/onClick_newSurvey">
                        <i class="fa fa-fw fa-plus"></i> New Survey
                    </button>
                    <h3>Surveys</h3>
                    <br>
                </header>
                
                <% if (m.surveyLister.c.surveyList.length === 0) { %>
                    <br><br><br>
                    <p class="centerText large">Get started by clicking 'New Survey' above.</p>
                    <br><br>
                <% } %>
                    
            <% } %><!-- end route guard -->
        </div><!-- end route 'surveyLister' -->


        <!-- ROUTE 'userLister': -->
        <div class="{{ m.router.ifRoute('userLister') }}" id="userLister">
            <% if (m.router.c.activeId === "userLister") { %>
                <header>
                    <div class="floatRight">
                        <% if (! m.userLister.o.isInviteFormVisible) { %>
                            <button class="btn btn-light" data-on="click" data-call="/userLister/onClick_toggleInviteForm">
                                <i class="fa fa-fw fa-plus"></i> Invite User
                            </button>
                        <% } %>
                    </div>
                    <h3>Users</h3>
                    <br>
                </header>
                <% if (m.userLister.o.isInviteFormVisible) { %>
                    <form class="border1pxLightGray padding1rem radiusQuarterRem mb-4 px-4"
                        data-on="submit" data-call="/userLister/onSubmit_inviteForm"
                    >
                        <span class="float-right btn btn-light btn-sm cursorPointer"
                            data-on="click" data-call="/userLister/onClick_toggleInviteForm"
                        >
                            <i class="fa fa-fw fa-times"></i>
                        </span>
                        <div class="form-group">
                            <h4 class="">Invite User</h4>
                        </div>
                        <div class="form-group">
                            <label>First Name</label>
                            <input type="text" name="fname" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Last Name</label>
                            <input type="text" name="lname" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" name="email" class="form-control" required>
                        </div>
                        <div class="form-group form-check">
                            <label>
                                <input type="checkbox" name="isAdmin" class="form-check-input">
                                Admin <span class="gray">(Check to make this user an Admin.)</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary"><i class="fa fa-fw fa-chevron-right"></i> Submit</button>
                        </div>
                    </form>
                <% } %>
                <ul class="list-unstyled">
                    <% _.each(m.userLister.c.userList, function (user) { %>
                        <li class="h4 {{uk.if(user.isDeactivated, 'darkGray', '')}}">
                            <div class="dropdown inlineBlock">
                                <button class="btn btn-light btn-sm dropdown-toggle" type="button"
                                    id="ddBtnFor-user-{{user._id}}"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                >
                                    <i class="fa fa-fw fa-bars"></i>
                                </button>
                                <div class="dropdown-menu" aria-labelledby="ddBtnFor-user-{{user._id}}">
                                    <% if ((! user.isVerified) && (! user.isDeactivated)) { %>
                                        <a class="dropdown-item cursorPointer" data-on="click"
                                            data-call="/userLister/onClick_reinvite" data-lit-arg="{{user._id}}"
                                        >
                                            Reinvite
                                        </a>
                                    <% } %>
                                    <a class="dropdown-item cursorPointer" data-on="click"
                                        data-call="/userLister/onClick_toggle_isDeactivated" data-lit-arg="{{user._id}}"
                                    >
                                        {{uk.if(user.isDeactivated, "Reactivate", "Deactivate")}}
                                    </a>
                                </div>
                            </div>
                            &nbsp;
                            <span class="cursorPointer" data-on="click" data-call="/onClick_toggleDropdownByBtnId"
                                data-lit-arg="ddBtnFor-user-{{user._id}}"
                            >
                                {{user.fname}} {{user.lname}} <small class="">{{user.email}}</small>
                            </span>
                        </li>
                    <% }); %>
                </ul>
            <% } %><!-- end route guard -->
        </div><!-- end route 'userLister' -->
        
        
        <!-- PLACEHOLDER ROUTE: '__route__name__' -->
        <div class="{{ m.router.ifRoute('__route__name__') }}" id="__route__name__">
            <% if (m.__your_condintion_here__ && m.router.c.activeId === "__route__name__") { %>
                <header>
                    <h3><i class="fa fa-fw fa-question burlyWood"></i> Route Title</h3>
                    <br>
                </header>
                Route-sepcific UI (and logic) goes here ...
                    
            <% } %><!-- end route guard -->
        </div><!-- end route '__route__name__' -->
        
    </script><!-- end #ukSource -->
    
    
    <div id="ukTarget"></div>
    
    <footer class="small gray">
        <br><br><hr class="mb-2">
        Powered by <!-- TODO: Set .ghRepoUrl's href via js. -->
        <a class="unsetColor underline ghRepoUrl" href="https://github.com/polydojo/zapfeedback" target="_blank">ZapFeedback</a>,
        a product from
        <a class="unsetColor underline" href="https://www.polydojo.com" target="_blank">Polydojo</a>.
    </footer>
    
    <script src="/front/dist/dash-bundle.js"></script>
</body>
</html>
